import pandas as pd
from sklearn.preprocessing import StandardScaler, LabelEncoder

df = pd.read_csv('credit_scoring_eng.csv')

print("Missing values in each column:\n", df.isnull().sum())

df_cleaned = df.dropna().copy()

scaler = StandardScaler()
df_cleaned.loc[:, ['total_income', 'days_employed']] = scaler.fit_transform(df_cleaned[['total_income', 'days_employed']])

le = LabelEncoder()

df_cleaned.loc[:, 'education'] = le.fit_transform(df_cleaned['education'].str.lower())
df_cleaned.loc[:, 'family_status'] = le.fit_transform(df_cleaned['family_status'].str.lower())
df_cleaned.loc[:, 'gender'] = le.fit_transform(df_cleaned['gender'])
df_cleaned.loc[:, 'income_type'] = le.fit_transform(df_cleaned['income_type'].str.lower())

df_cleaned.loc[:, 'purpose'] = df_cleaned['purpose'].apply(
    lambda x: 'house' if 'house' in x.lower() else 'education' if 'education' in x.lower() else 'car' if 'car' in x.lower() else 'other'
)

df_cleaned.loc[:, 'days_employed'] = df_cleaned['days_employed'].abs()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

df_cleaned.loc[:, 'age'] = 2024 - df_cleaned['dob_years']

df_cleaned.loc[:, 'income_category'] = pd.cut(df_cleaned['total_income'], bins=[0, 100000, 200000, 300000], labels=['Low', 'Medium', 'High'])

df_cleaned.to_csv('credit_scoring_eng_cleaned.csv', index=False)

print(df_cleaned.head())
